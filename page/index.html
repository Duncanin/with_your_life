<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <link
      rel="icon"
      type="image/svg+xml"
      href="../assets/photo/logo-icon/logo-lcon.svg"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>伴你在日常｜首頁</title>
    <%- include('./layout/link-icon'); -%>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/gsap@3.12.2/dist/gsap.min.js"></script>
    <script src="https://unpkg.com/gsap@3.12.2/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/parallax/3.1.0/parallax.min.js"></script>

  </head>
  
  <body>
    <%- include('./layout/header-loginOut'); -%>
    <div class="banner d-flex">
      <div class="container d-flex position-relative">
        <div class="">

          <div class="position-absolute start-50 bottom-0 translate-middle-x w-75 mb-12 scroll-1 d-block d-md-none">
            <img src="/assets/photo/index/wheelchair-phone.svg" alt="bg-img" class="d-block d-md-none mx-auto w-100 h-auto">
          </div>
  
          <div class="position-absolute start-50 bottom-0 translate-middle-x w-100 mb-14 scroll-1 d-none d-md-block">
            <img src="/assets/photo/index/wheelchair.svg" alt="desk-img" class="d-block mx-auto w-100 h-auto">
          </div>
  
          <div class="position-absolute start-0 bottom-0 d-flex flex-column bg-scroll w-100 d-md-none scroll-2 d-md-none">
            <img src="/assets/photo/index/02.png" alt="phone-img" class="h-100 w-auto d-block">
            <div>
              <img src="/assets/photo/index/01.png" alt="phone-img">
              <img src="/assets/photo/index/03.png" alt="phone-img">
            </div>
          </div>
  
          <div class="position-absolute start-0 bottom-0 d-flex flex-column bg-scroll w-100 scroll-2 d-none d-md-block mx-auto">
            <img src="/assets/photo/index/family.svg" alt="family-img" class="w-100 h-auto d-block">
          </div>
  
          <h1 class="fs-2 fs-md-0 m-auto title-shadow text-center position-absolute banner-title start-50 translate-middle firsi-title">
            一個家，
            <span class="d-block text-nowrap mt-2">
              應該是什麼樣子？
            </span>
          </h1>
          <h1 class="fs-2 fs-md-0 m-auto title-shadow text-center position-absolute banner-title start-50 translate-middle scroll-1">
            <span class="text-nowrap">
              一點一點，我們改變了
            </span>
            <span class="d-block d-sm-inline">這個家，</span>
            <span class="d-block text-nowrap mt-2">
              讓安心成為日常
            </span>
          </h1>
          <h1 class="fs-2 fs-md-0 m-auto title-shadow text-center position-absolute banner-title start-50 translate-middle scroll-2 text-nowrap">
            家，有貼心就完整了
            <span class="d-block text-nowrap mt-2">
              伴你在日常
            </span>
          </h1>
        </div>


      </div>
      <div class="bottom bg-background">
        <button
          type="button"
          class="btn btn-secondary-500 fs-6 text-white fw-semibold d-block mx-auto px-5"
        >
          立即了解
          <span class="material-symbols-outlined align-bottom fs-5"
            >arrow_forward</span
          >
        </button>
      </div>
    </div>

    <script>
      gsap.registerPlugin(ScrollTrigger);
      gsap.from(".banner", {
        opacity: 0,
        scale: 1.2,
        duration: 5,
        ease: "power2.out"
      });

      const tl = gsap.timeline({
        scrollTrigger: {
          trigger: ".banner",
          start: "top top",
          end: "+=200%",
          scrub: true,
          pin: true,
          markers: false
        }
      });

      tl.to(".firsi-title", {
        opacity: 0,
        duration: 0.5
      }).from(".scroll-1", {
        opacity: 0,
        duration: 1
      }).to(".scroll-1", {
        opacity: 0,
        duration: 1
      }).from(".scroll-2", {
        opacity: 0,
        duration: 2
      }, "<"); // "<" 表示與上一個動畫同時開始

      //  加入左右視差效果
      gsap.to(".scroll-1", {
        x: 30,  // 往右偏移一點點
        ease: "none",
        scrollTrigger: {
          trigger: ".banner",
          start: "top top",
          end: "bottom top",
          scrub: true
        }
      });

      gsap.to(".scroll-2", {
        x: -20,  // 往左偏移一點點
        ease: "none",
        scrollTrigger: {
          trigger: ".banner",
          start: "top top",
          end: "bottom top",
          scrub: true
        }
      });

    </script>

    <!-- 滾動空間區塊 -->
    <div class="d-none" style="height: 200vh; background-color: #f0f0f0;"></div>

    <div class="service-item">
      <div class="container">
        <div class="py-10 py-md-14 position-relative">
          <h2 class="fs-3 fs-md-1 text-center mb-6 mb-md-10">
            伴你ㄟ日常，照顧路上幫你想得更周到
          </h2>
          <div class="overflow-x-auto">
            <div class="d-flex gap-4 gap-md-6">
              <% const cards = [
                { img: '/assets/photo/index/service.svg', title: '輔具推薦', desc: '依不同需求推薦適合輔具' },
                { img: '/assets/photo/index/service02.svg', title: '補助指南', desc: '清楚標示可申請政府補助的商品' },
                { img: '/assets/photo/index/service03.svg', title: '一站式選購', desc: '居家、衛浴等輔具整合齊備' }
              ]; %>
      
              <% cards.forEach(card => { %>
                <div class="card pb-6">
                  <img src="<%= card.img %>" alt="<%= card.title %>">
                  <div class="card-body p-0 mt-4 text-center">
                    <h3 class="fs-5 fs-md-4 fw-bold mb-3 mb-md-4"><%= card.title %></h3>
                    <p class="text-neutral-700 fs-6 fs-md-5"><%= card.desc %></p>
                  </div>
                </div>
              <% }); %>
            </div>
          </div>
          <div class="tag position-absolute">
            <img src="/assets/photo/index/tag.svg" alt="" class="d-block w-100 h-100 object-fit-cover">
          </div>
        </div>
      </div>

    </div>

    <div class="sorted bg-background">
      <div class="container">
        <div class="py-10 py-md-14">
          <h2 class="fs-3 fs-md-1 text-center mb-6 mb-md-10">先從分類逛起，陪你一步步找適合的</h2>
          <% const categories = [
            { img: '/assets/photo/index/sorted/wheelchair.svg', text: '行動協助' },
            { img: '/assets/photo/index/sorted/meal.svg', text: '用餐照護' },
            { img: '/assets/photo/index/sorted/toilet.svg', text: '如廁便利' },
            { img: '/assets/photo/index/sorted/bath.svg', text: '洗浴安全' },
            { img: '/assets/photo/index/sorted/welfare.svg', text: '補助專區' },
            { img: '/assets/photo/index/sorted/allClass.svg', text: '全部分類' }
          ]; %>
          <div class="d-grid gap-4 gap-md-6 sorted-grid mx-auto">
            <% categories.forEach(category => { %>
              <div class="text-center bg-white sorted-item">
                <img src="<%= category.img %>" alt="<%= category.text %>" class="d-block w-50 h-auto object-fit-cover" />
                <p class="fs-5 fs-md-4 fw-semibold lh-sm"><%= category.text %></p>
              </div>
            <% }); %>
          </div>

        </div>

      </div>
    </div>

    <div class="map">
      <div class="container">
        <div class="py-10 py-md-14">
          <h2 class="fs-md-1 mb-6 mb-md-10 text-center">陪你找，最近的輔具好所在</h2>
          <div class="position-relative d-block mx-auto w-100" style="min-width: 350px; max-width: 416px;">
            <input type="text" id="searchInput" placeholder="搜尋鄰近的輔具中心" class="form-control w-100 rounded-20 border-2 border-neutral-200 py-3 px-4"/>
          <button onclick="searchLocation()" class="position-absolute top-50 translate-middle-y end-0 border-0 text-secondary-500 p-0 me-4" style="appearance: none; background: none; width: 24px; height: 24px;">
            <span class="material-symbols-outlined align-bottom">distance</span>
          </button>
          </div>
          <div>
            <div class="d-flex justify-content-center my-4 my-md-6 region-tabs">
              <button class="btn btn-link text-primary-300 active" data-region="north" onclick="selectRegion(this)">北部</button>
              <button class="btn btn-link text-primary-300" data-region="central" onclick="selectRegion(this)">中部</button>
              <button class="btn btn-link text-primary-300" data-region="south" onclick="selectRegion(this)">南部</button>
              <button class="btn btn-link text-primary-300" data-region="east" onclick="selectRegion(this)">東部</button>
              <button class="btn btn-link text-primary-300" data-region="island" onclick="selectRegion(this)">離島</button>
            </div>
            <div id="map" style="height: 400px;" class="rounded-20 border border-2 border-background"></div>

            <script>
              const regionData = {
                north: { coords: [25.033964, 121.564468], name: "台北101" },
                central: { coords: [24.147736, 120.673648], name: "台中火車站" },
                south: { coords: [22.627278, 120.301435], name: "高雄85大樓" },
                east: { coords: [23.973875, 121.600801], name: "花蓮" },
                island: { coords: [23.101013, 121.36566], name: "綠島" }
              };

              const map = L.map('map').setView(regionData.north.coords, 13);
              L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
              }).addTo(map);
              let marker = L.marker(regionData.north.coords).addTo(map).bindPopup(regionData.north.name).openPopup();

              function updateMapLocation(region) {
                const { coords, name } = regionData[region];
                map.setView(coords, 13);
                marker.setLatLng(coords).setPopupContent(name).openPopup();
              }

              function searchLocation() {
                const query = document.getElementById('searchInput').value;
                if (!query) return;

                fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}`)
                  .then(response => response.json())
                  .then(data => {
                    if (data.length === 0) {
                      alert('找不到地點');
                      return;
                    }
                    const { lat, lon, display_name } = data[0];
                    const coords = [parseFloat(lat), parseFloat(lon)];
                    map.setView(coords, 13);
                    marker.setLatLng(coords).setPopupContent(display_name).openPopup();
                  })
                  .catch(error => {
                    console.error('地點搜尋錯誤：', error);
                    alert('搜尋失敗，請稍後再試。');
                  });
              }

              function selectRegion(button) {
                document.querySelectorAll('.region-tabs button').forEach(btn => {
                  btn.classList.remove('active', 'text-dark-emphasis');
                  btn.classList.add('text-secondary');
                });
                button.classList.add('active', 'text-dark-emphasis');
                button.classList.remove('text-secondary');
                updateMapLocation(button.dataset.region);
              }
            </script>
          </div>
        </div>
      </div>
    </div>

    <div class="companionist">
      <div class="container">
        <div class="py-10 py-md-14">
          <div class="text-center mb-6 mb-md-10">
            <h2 class="fs-3 fs-md-1 mb-4 mb-md-6">伴你走過平凡ㄟ日常</h2>
            <p class="fs-5 text-secondary-500">陪診師，那天的專屬夥伴，陪你走過每一段醫療旅程</p>
          </div>
          
          <div class="desc bg-secondary-50 rounded-20 py-6 px-4 p-md-10 mb-4 d-md-flex gap-10">
            <img src="/assets/photo/index/companionist.svg" alt="companionist" class="ratio-1x1 d-block mb-4">
            <div class="d-flex gap-6 gap-md-10 flex-column my-md-auto">
              <div>
                <h3 class="fs-5 fs-md-4 mb-3 mb-md-4">一人一師，專業陪診</h3>
                <p class="text-neutral-700 fs-6">預約掛號、排隊取藥、解讀醫囑，我們幫你打點。</p>
              </div>
              <div>
                <h3 class="fs-5 fs-md-4 mb-3 mb-md-4">有溫度的陪伴</h3>
                <p class="text-neutral-700 fs-6">會聽、會聊、會教，讓你安心踏進診間（沒有人會被留在門外）。</p>
              </div>
              <div>
                <h3 class="fs-5 fs-md-4 mb-3 mb-md-4">解除流程煩惱</h3>
                <p class="text-neutral-700 fs-6">訓練有素的小程序助理，掌握看診進度，隨時回報家人最新狀態。</p>
              </div>
            </div>
          </div>
  
          <div class="cta d-flex flex-column flex-md-row gap-4 gap-md-6">
            <div class="bg-primary-50 rounded-20 d-flex flex-column justify-content-center align-items-center gap-3 py-6 py-md-10 px-4">
              <div style="width: 35%; max-width: 107px;">
                <img src="/assets/photo/index/companionist01.svg" alt="" class="d-block w-100 h-auto object-fit-cover">
              </div>
              <h3 class="fs-5 fs-md-4 text-center">視力退化，不敢單獨出門怎麼辦？</h3>
              <button type="button" class="btn btn-outline-primary-500 py-2 px-4 d-flex justify-content-center align-items-center gap-1 fs-7 fw-semibold">
                瞭解更多
                <span class="material-symbols-outlined align-bottom fs-6">arrow_forward</span>
              </button>
            </div>
  
            <div class="bg-primary-50 rounded-20 d-flex flex-column justify-content-center align-items-center gap-3 py-6 py-md-10 px-4">
              <div style="width: 35%; max-width: 107px;">
                <img src="/assets/photo/index/companionist02.svg" alt="" class="d-block w-100 h-auto object-fit-cover">
              </div>
              <h3 class="fs-5 fs-md-4 text-center">「剛確診新病症，完全聽不懂醫生在說什麼⋯」</h3>
              <button type="button" class="btn btn-outline-primary-500 py-2 px-4 d-flex justify-content-center align-items-center gap-1 fs-7 fw-semibold">
                瞭解更多
                <span class="material-symbols-outlined align-bottom fs-6">arrow_forward</span>
              </button>
            </div>
          </div>
        </div>
      </div>

    </div>
    
    <div class="feedback">
      <div class="container">
        <div class="pt-10 pb-13 pt-md-14 pb-md-16 position-relative">
          <h2 class="fs-3 fs-md-1 mb-6 mb-md-10 text-center">陪你ㄟ日常，聽聽他們說</h2>
          
          <div id="feedbackIndicators" class="carousel-indicators justify-content-center mb-10 mb-md-12"></div>
          
          <div class="d-flex overflow-auto gap-4 scroll-smooth px-3" id="feedbackScrollTrack"></div>
          <script type="module">
            // feedbackList 資料
            const feedbackList = [
              {
                img: new URL('../assets/photo/index/feedback/feedback1.svg', import.meta.url).href,
                alt: '蔡小姐',
                role: '居家照顧員',
                name: '蔡小姐｜35歲',
                text: '我每天跑很多個案，家屬第一次照顧常手忙腳亂。我都推薦他們這個網站，分類清楚、說明簡單，還有補助資訊，幫助減少很多問題，讓照顧更有力量。'
              },
              {
                img: new URL('../assets/photo/index/feedback/feedback2.svg', import.meta.url).href,
                alt: '林小姐',
                role: '照顧者',
                name: '林小姐｜52歲',
                text: '媽媽中風後，我幾乎一手包辦她的生活起居——上網找資訊時，常常看不懂，後來朋友推薦這個網站，分類清楚又好懂。這是我第一次覺得，買輔具不是一個人的戰鬥。'
              },
              {
                img: new URL('../assets/photo/index/feedback/feedback3.svg', import.meta.url).href,
                alt: '周伯伯',
                role: '自行選購',
                name: '周伯伯｜68歲',
                text: '膝蓋退化，走路越來越不穩，連出門都會感到害怕——想找助行器，卻被許多專業網站搞得看不懂。這個平台讓我安心，分類清晰，說明簡單明瞭，還會告訴我適合的使用情境。'
              },
              {
                img: new URL('../assets/photo/index/feedback/feedback1.svg', import.meta.url).href,
                alt: '蔡小姐',
                role: '居家照顧員',
                name: '蔡小姐｜35歲',
                text: '我每天跑很多個案，家屬第一次照顧常手忙腳亂。我都推薦他們這個網站，分類清楚、說明簡單，還有補助資訊，幫助減少很多問題，讓照顧更有力量。'
              },
              {
                img: new URL('../assets/photo/index/feedback/feedback2.svg', import.meta.url).href,
                alt: '林小姐',
                role: '照顧者',
                name: '林小姐｜52歲',
                text: '媽媽中風後，我幾乎一手包辦她的生活起居——上網找資訊時，常常看不懂，後來朋友推薦這個網站，分類清楚又好懂。這是我第一次覺得，買輔具不是一個人的戰鬥。'
              },
              {
                img: new URL('../assets/photo/index/feedback/feedback3.svg', import.meta.url).href,
                alt: '周伯伯',
                role: '自行選購',
                name: '周伯伯｜68歲',
                text: '膝蓋退化，走路越來越不穩，連出門都會感到害怕——想找助行器，卻被許多專業網站搞得看不懂。這個平台讓我安心，分類清晰，說明簡單明瞭，還會告訴我適合的使用情境。'
              },
            ];
            const track = document.getElementById('feedbackScrollTrack');
            feedbackList.forEach((item, index) => {
              const card = document.createElement('div');
              card.className = 'card bg-background px-4 py-6 p-md-8 flex-shrink-0 gap-4 d-flex flex-column gap-4 gap-md-6';
              card.style.width = '320px';
              card.innerHTML = `
                <img src="${item.img}" class="rounded-circle mx-auto" alt="${item.alt}">
                <div>
                  <h4 class="fs-6 fs-md-5 text-primary-500 text-center mb-3">${item.role}</h4>
                  <h3 class="fs-5 fs-md-4 text-center mb-2">${item.name}</h3>
                </div>
                <p class="fs-7 fs-md-6 text-center text-neutral-700">${item.text}</p>
              `;
              track.appendChild(card);
            });
            // 指標
            const indicators = document.getElementById('feedbackIndicators');
            const cards = track.querySelectorAll('.card');
            cards.forEach((_, i) => {
              const indicator = document.createElement('span');
              indicator.className = 'indicator-dot';
              if (i === 0) indicator.classList.add('active');
              indicator.addEventListener('click', () => {
                track.scrollTo({ left: i * 336, behavior: 'smooth' });
              });
              indicators.appendChild(indicator);
            });
            track.addEventListener('scroll', () => {
              const scrollLeft = track.scrollLeft;
              const index = Math.round(scrollLeft / 336);
              indicators.querySelectorAll('span').forEach((el, i) => {
                el.classList.toggle('active', i === index);
              });
            });

            // 1. 複製所有卡片，並接在尾端
            cards.forEach(card => {
              const clone = card.cloneNode(true);
              track.appendChild(clone);
            });

            // 2. 滾動自動判斷是否達尾端並重置位置
            track.addEventListener('scroll', () => {
              const scrollLeft = track.scrollLeft;
              const maxScroll = track.scrollWidth - track.clientWidth;

              // 判斷滾到快結尾時（原卡片寬度 * 卡片數）
              if (scrollLeft >= maxScroll - (cards.length * 336)) {
                // 瞬間跳回開頭
                track.scrollLeft = 0;
              }

              // 更新指標
              const index = Math.round(scrollLeft / 336) % cards.length;
              indicators.querySelectorAll('span').forEach((el, i) => {
                el.classList.toggle('active', i === index);
              });
            });
          </script>
        </div>
      </div>
    </div>

    <script type="module" src="../main.js"></script>
    <%- include('./layout/footer'); -%>

  </body>
</html>